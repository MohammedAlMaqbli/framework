<html><head>
    <style>
body {
    margin: 0;
}

td {
   color: white;
}

.visual-control {
    background: black;
    min-height: 100%;
    color: white;
    padding: 20px;
}

.visual-control .title {
    font-weight: bold;
    width: 100%;
    text-align: center;
}

.visual-control .subtitle-section {
    display: flex;
    justify-content: space-between;
}

.visual-control .subtitle-section div {
    width: 30%;
    text-align: center;
    padding: 20px;
}

.visual-control .subtitle-section div:first-child {
    text-align: left;
}

.visual-control .subtitle-section div:last-child {
    text-align: right;
}

.visual-control .subtitle-section h3 {
    display: inline;
}

.visual-control .subtitle-section-label {
    margin-right: 2rem;
}

.visual-control .content-wrapper {
    display: flex;
}

.visual-control .content {
    padding: 20px;
}

.visual-control table {
    table-layout: fixed;
    width: 100%;
}

.visual-control table {
    border-collapse: collapse;
}

.visual-control table,
.visual-control th,
.visual-control td {
    border: 5px solid white;
}

.visual-control th,
.visual-control td {
    padding: 7px;
    text-align: center;
    font-weight: bold;
}

.visual-control th {
    color: yellow;
}

.visual-control .content h1,
.visual-control th h3 {
    margin: 0;
}

.visual-control .status-planning {
    background-color: blue;
}

.visual-control .status-on-process {
    background-color: yellow;
    color: black;
}

.visual-control .status-finish {
    background-color: green;
}

.visual-control .status-uncompleted {
    background-color: red;
}
    </style>
</head>
<body>
        <div class="visual-control">
          <h1 class="title">TRIGGER BOARD</h1>
          <div class="subtitle-section">
            <div>
              <h3 class="subtitle-section-label">SHIFT:</h3>
              <h3 class="subtitle-section-value">1 / 2</h3>
            </div>
            <div>
              <h3 class="subtitle-section-label">Tanggal Produksi:</h3>
              <h3 id="production_date" class="subtitle-section-value">13 / Feb / 2020</h3>
            </div>
            <div>
              <h3 class="subtitle-section-label">Waktu Sekarang:</h3>
              <h3 id="time_now" class="subtitle-section-value">19:42</h3>
            </div>
          </div>
          <div class="content-wrapper">
            <div class="content">
              <h1>LINE MCVT</h1>
              <table>
                <tbody><tr>
                  <th><h3>IHPL</h3></th>
                  
                  
                  
                  
                  
                <th><h3>CO</h3></th></tr>
                
                
                
              </tbody></table>
            </div>
            
          <div class="content">
              <h1>LINE FLEXI</h1>
              <table>
                <tbody><tr>
                  <th><h3>IHPL</h3></th>
                  
                  
                  
                  
                  
                <th><h3>CO</h3></th></tr>
                
                
                
              </tbody></table>
            </div></div>
        <div class="content-wrapper">
            <div class="content">
              <h1>LINE 4WD TRF</h1>
              <table>
                <tbody><tr>
                  <th><h3>IHPL</h3></th>
                  
                  
                  
                  
                  
                <th><h3>CO</h3></th></tr>
                
                
                
              </tbody></table>
            </div>
            
          <div class="content">
              <h1>LINE 4WD DPS</h1>
              <table>
                <tbody><tr>
                  <th><h3>IHPL</h3></th>
                  
                  
                  
                  
                  
                <th><h3>CO</h3></th></tr>
                
                
                
              </tbody></table>
            </div></div></div>
<script>
//const time = new Date()
//time.setHours(7, 15, 0, 0, 0)

async function get_sequence() {
  const date = new Date()
  document.getElementById('production_date').innerHTML = (date.toDateString()).split(' ').slice(1, -1).reverse().concat([date.getFullYear()]).join(' / ')
  document.getElementById('time_now').innerHTML = date.toTimeString().split(':').slice(0, 2).join(':')
  const promises = ['mcvt', 'flexi'].map(async (type) => {
    const records = await fetch(`http://172.16.2.21:8069/api/search?login=8c46b255e370acbdf61c5b47e4696dfa&password=982063ae578804d3c36ae646ffaecb64&encrypted=true&model=mrp.sequence&args=[["date","=","${window.location.hash.slice(1)}"], ["type","=","${type}"], ["finished", "!=", true]]&options={"order": "sequence asc"}`).then((response) => response.json());
    if (!Array.isArray(records.values)) return;
    await Promise.all(records.values.map(async (value, index) => {
      if ((index + 1) > 5) return;
      const model = await fetch('http://172.16.2.21:8069/api/browse?login=8c46b255e370acbdf61c5b47e4696dfa&password=982063ae578804d3c36ae646ffaecb64&encrypted=true&model=mrp.bom&ids=' + value.bom_id).then((response) => response.json());
      document.getElementById('model_' + type + '_' + (index + 1)).innerHTML = model.values.name.split(' ')[0].split('(')[0]
      document.getElementById('sequence_' + type + '_' + (index + 1)).innerHTML = value.sequence
      document.getElementById('qty_' + type + '_' + (index + 1)).innerHTML = parseInt(value.quantity) || 30
      if (value.location_name) {
        document.getElementById('location_' + type + '_' + (index + 1)).innerHTML = value.location_name;
        if (value.location_name.toLowerCase().match('assy')) ['model', 'location', 'qty'].forEach((field) => document.getElementById(field + '_' + type + '_' + (index + 1)).className = 'status-finish')
        if (value.location_name.toLowerCase().match('scr')) ['model', 'location', 'qty'].forEach((field) => document.getElementById(field + '_' + type + '_' + (index + 1)).className = 'status-on-process')
      }
      //time.setMinutes(time.getMinutes() + 15)
    }));
  });
  await Promise.all(promises);
  setTimeout(() => location.reload(), 10 * 1000);
}

//get_sequence().catch(window.alert)
</script>



</body></html>
